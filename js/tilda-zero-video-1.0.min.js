function t_videoPlayer__init(e,t){return"mp4"===t||"webm"===t?t_video__initPlayer__htmlVideo(e,t):"rutube"===t?t_video__initPlayer__rutube(e):"vkvideo"===t?t_video__initPlayer__vkvideo(e):"youtube"===t?t_video__initPlayer__youtube(e):"vimeo"===t?t_video__initPlayer__vimeo(e):"kinescope"===t?t_video__initPlayer__kinescope(e):"boomstream"===t?t_video__initPlayer__boomstream(e):(console.warn("unsupported video type:",t),Promise.reject(null))}function t_video__doRutubeCommand(e,t){e.contentWindow.postMessage(JSON.stringify({type:"player:"+t,data:{}}),"*")}function t_video__doVimeoCommand(e,t){e.contentWindow.postMessage(JSON.stringify({method:t,value:"true"}),"*")}function t_video__doBoomstreamCommand(e,t,o){e.contentWindow.postMessage({code:o,method:"action",action:t,data:""},"*")}function t_video__getPlayer(e){var t;return e.TildaVideoPlayer||null}function t_video__initPlayer__youtube(e){var t="youtube";return new Promise((function(o,i){var r=e.querySelector("iframe");if(!r)return i(new Error(t+": IFrame Element not Found"));t_onFuncLoad("t_loadJsFile",(function(){t_loadJsFile("https://www.youtube.com/iframe_api")})),t_onFuncLoad("YT",(function(){var i=r.id;if(!YT.Player)return setTimeout((function(){t_video__initPlayer__youtube(e).then(o)}),300);var a=new YT.Player(i,{events:{onReady:function i(a){var n=a.target,d={videoType:t,pause:function e(){return n.pauseVideo()},play:function e(){return n.playVideo()},videoEl:r,player:n};return e.TildaVideoPlayer=d,o(d)}}})}))}))}function t_video__initPlayer__vimeo(e){var t="vimeo";return new Promise((function(o,i){var r=e.querySelector("iframe");if(!r)return i(new Error(t+": IFrame Element not Found"));var a={pause:function e(){return t_video__doVimeoCommand(r,"pause")},play:function e(){return t_video__doVimeoCommand(r,"play")},videoEl:r,videoType:t};e.TildaVideoPlayer=a,o(a)}))}function t_video__initPlayer__kinescope(e){var t="kinescope";return new Promise((function(o,i){var r=e.querySelector("iframe");if(!r)return i(new Error(t+": IFrame Element not Found"));t_onFuncLoad("t_loadJsFile",(function(){t_loadJsFile("https://player.kinescope.io/latest/iframe.player.js")})),t_onFuncLoad("Kinescope",(function(){var i=r.id,a=r.src;Kinescope.IframePlayer.create(i,{url:a}).then((function(i){var a={pause:function e(){return i.pause()},play:function e(){return i.play()},player:i,videoEl:r,videoType:t};e.TildaVideoPlayer=a,o(a)}))}))}))}function t_video__initPlayer__vkvideo(e){var t="vkvideo";return new Promise((function(o,i){var r=e.querySelector("iframe");if(!r)return i(new Error(t+": IFrame Element not Found"));t_onFuncLoad("t_loadJsFile",(function(){t_loadJsFile("https://vk.com/js/api/videoplayer.js")})),t_onFuncLoad("VK",(function(){var i=VK.VideoPlayer(r),a={videoType:t,pause:function e(){return i.pause()},play:function e(){return i.play()},videoEl:r,player:i};return e.TildaVideoPlayer=a,o(a)}))}))}function t_video__initPlayer__rutube(e){var t="rutube";return new Promise((function(o,i){var r=e.querySelector("iframe");if(!r)return i(new Error(t+": IFrame Element not Found"));var a={videoType:t,pause:function e(){return t_video__doRutubeCommand(r,"pause")},play:function e(){return t_video__doRutubeCommand(r,"play")},videoEl:r};return e.TildaVideoPlayer=a,o(a)}))}function t_video__initPlayer__htmlVideo(e,t){return new Promise((function(o,i){var r=e.querySelector("video");if(!r)return i(new Error(t+": Video Element not Found"));var a={videoType:t,pause:function e(){return r.pause()},play:function e(){return r.play()},videoEl:r};return e.TildaVideoPlayer=a,o(a)}))}function t_video__initPlayer__boomstream(e){var t="boomstream";return new Promise((function(o,i){var r=e.querySelector("iframe");if(!r)return i(new Error(t+": IFrame Element not Found"));var a,n=/boomstream.com\/(?:balancer\/)?([A-Za-z0-9-]+)/,d=r.src.match(n);if(!d)return i(new Error(t+": VideoID not Found"));var u={pause:function e(){return t_video__doBoomstreamCommand(r,"pause",d[1])},play:function e(){return t_video__doBoomstreamCommand(r,"play",d[1])},videoEl:r,videoType:t};return e.TildaVideoPlayer=u,o(u)}))}function t396_initVideo(e){var t=e.querySelector(".tn-atom__videoiframe"),o=e.querySelector(".tn-atom");if(o&&t&&!t.querySelector("iframe, video")){o.style.backgroundColor="#000";var i=document.getElementById("allrecords"),r=e?e.closest(".r"):null,a={recid:r?r.id.replace("rec",""):"",elementID:e.getAttribute("data-elem-id")||"",hasCover:"y"===o.getAttribute("data-atom-video-has-cover"),hasAutoplay:"y"===t396_elem__getFieldValue(e,"autoplay"),hasInfo:"y"===t396_elem__getFieldValue(e,"showinfo"),hasLoop:"y"===t396_elem__getFieldValue(e,"loop"),isMuted:"y"===t396_elem__getFieldValue(e,"mute"),startSec:t396_elem__getFieldValue(e,"startsec")||"",endSec:t396_elem__getFieldValue(e,"endsec")||"",vimeoHash:t.getAttribute("data-vimeohash")||"",hiddenControls:"hidden"===t.getAttribute("data-video-controls"),isCoverFit:"cover"===t.getAttribute("data-video-object-fit"),isEditMode:!!i&&"edit"===i.getAttribute("data-tilda-mode"),isLazy:"y"===window.lazy},n,d="",u;document.createElement("script").textContent='lazyload_iframe = new LazyLoad({elements_selector: ".t-iframe"});';var s=t.getAttribute("data-youtubeid"),l=t.getAttribute("data-vimeoid"),_=t.getAttribute("data-mp4video"),c=t.getAttribute("data-vkvideoid"),v=t.getAttribute("data-rutubeid"),m=t.getAttribute("data-kinescopeid"),p=t.getAttribute("data-webmvideo"),y=t.getAttribute("data-iframevideo"),f="";if(s&&(f="youtube",d=t396_video__generateIframeSrc(s,a,"youtube"),n=t396_video__createIframe(d,a,"youtube"),a.isLazy||n.addEventListener("load",(function(){o.style.backgroundColor=""}))),l&&(f="vimeo",d=t396_video__generateIframeSrc(l,a,"vimeo"),n=t396_video__createIframe(d,a,"vimeo")),c&&(f="vkvideo",d=t396_video__generateIframeSrc(c,a,"vkvideo"),n=t396_video__createIframe(d,a,"vkvideo")),v&&(f="rutube",d=t396_video__generateIframeSrc(v,a,"rutube"),n=t396_video__createIframe(d,a,"rutube")),m&&(f="kinescope",d=t396_video__generateIframeSrc(m,a,"kinescope"),n=t396_video__createIframe(d,a,"kinescope")),y&&(f="iframe",n=t396_video__createIframe(d=y,a,"iframe")),_&&(f="mp4"),p&&(f="webm"),_||p){var b=_||p;a.type="webm",_&&(a.type="mp4"),a.hasCover&&(a.isCoverFit=!0),n=t396_video__createVideoHTML(b,a);var h="display: flex; align-items: center;height:100%;";a.isCoverFit&&(h+="position: relative;"),t.style.cssText=h}if(a.hasCover)o.addEventListener("click",(function(){if(!o.querySelector("iframe, video")){n&&t.appendChild(n),o.style.backgroundImage="none";var e=o.querySelector(".tn-atom__video-play-link");e&&(e.style.display="none"),(_||p)&&n&&!o.processVideo&&(n.play(),o.processVideo=!0)}}));else if(n&&t.appendChild(n),s&&a.isLazy&&t396_video__processYoutubeIframeBgOnLoad(o,n),_||p){var g=t.querySelector("video");t396_video__setLoaderForHTMLVideo(o,g,a.isCoverFit),t396_video__lazyLoadProcessHTMLVideo(g,a),g&&!a.isEditMode&&a.hiddenControls&&!a.hasAutoplay&&g.addEventListener("click",(function(){g.readyState<2||(g.paused?g.play():g.pause())}))}t396__video__listenToVisibilityChange(t,f)}}function t396_video__processYoutubeIframeBgOnLoad(e,t){if(t&&e&&"MutationObserver"in window){var o=new MutationObserver((function(i){i.forEach((function(i){"attributes"===i.type&&"src"===i.attributeName&&i.target.src&&t.addEventListener("load",(function(){e.style.backgroundColor="",o.disconnect()}))}))}));o.observe(t,{attributes:!0})}}function t396_video__generateIframeSrc(e,t,o){var i,r={youtube:"https://www.youtube.com/embed/",vimeo:"//player.vimeo.com/video/",vkvideo:"https://vk.com/video_ext.php",rutube:"https://rutube.ru/play/embed/",kinescope:"https://kinescope.io/embed/"}[o],a=r+e+"?";if("youtube"===o&&(t.hasInfo&&(a+="&showinfo=1"),t.hasLoop&&(a+="&loop=1&playlist="+e),t.startSec>0&&(a+="&start="+t.startSec),t.endSec>0&&(a+="&end="+t.endSec),t.isMuted&&(a+="&mute=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(a+="&autoplay=1",t.hasCover&&(a+="&amp;rel=0")),a+="&enablejsapi=1"),"vimeo"===o&&(a+="color=ffffff&badge=0",t.vimeoHash&&(t.vimeoHash=t.vimeoHash.trim(),a+=t.vimeoHash?"&h="+t.vimeoHash+"&":""),t.hasInfo?a+="&title=1&byline=1&portrait=1":a+="&title=0&byline=0&portrait=0",t.startSec>0&&(a+="#t="+t.startSec+"s"),t.endSec>0&&(a+="&end="+t.endSec+"s"),t.hasLoop&&(a+="&loop=1"),t.isMuted&&(a+="&muted=1"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(a+="&autoplay=1",a+="&autopause=false"),a+="&api=1"),"vkvideo"===o){var n=e.split("_"),d=n[0],u=n[1],s=n[2];a=r+"?oid="+d+"&id="+u+"&color=ffffff1&hd=2",s&&(a+="&hash="+s),t.startSec>0&&(a+="&t="+t.startSec+"s"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(a+="&autoplay=1"),a+="&js_api=1"}return"rutube"===o&&(e.includes("?p=")&&(a=r+e),t.startSec>0&&(a+="&t="+t.startSec)),"kinescope"===o&&(t.startSec>0&&(a+="&t="+t.startSec),t.isMuted&&(a+="&muted=true"),(t.hasCover||t.hasAutoplay&&!t.isEditMode)&&(a+="&autoplay=true",a+="&autopause=false"),t.hasLoop&&(a+="&loop=true")),a}function t396_video__createIframe(e,t,o){var i=document.createElement("iframe"),r=o;return r+="-iframe-"+t.recid+"-"+t.elementID,i.id=r,i.width="100%",i.height="100%",i.frameBorder="0",i.allowFullscreen=!0,i.allow="autoplay; encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;",!t.hasCover&&t.isLazy?(i.classList.add("t-iframe"),i.setAttribute("data-original",e)):i.src=e,t.hasCover&&(i.allow="autoplay"),i}function t396_video__createVideoHTML(e,t){var o=window.t396__isMobile&&window.isSafari&&!t.hasCover?"#t=0.001":"",i=e?'<source src="'+e+o+'" type="video/'+t.type+'">':"",r=document.createElement("video");return r.style.cssText="width: 100%;"+(t.hasCover?"":"display:none;")+(t.isCoverFit?"height: 100%; object-fit: cover; position: absolute;":"")+(t.hiddenControls&&!t.hasAutoplay?"cursor: pointer;":""),r.id="html-video-"+t.recid+"-"+t.elementID,r.innerHTML=i,t.hiddenControls||(r.controls=!0),!t.isEditMode&&t.hasAutoplay&&(r.autoplay=!0),t.isMuted&&(r.muted=!0),r.playsInline=!0,t.hasLoop&&(r.loop=!0),r}function t396_video__lazyLoadProcessHTMLVideo(e,t){var o;t.hasAutoplay&&!t.isEditMode&&e&&"IntersectionObserver"in window&&new IntersectionObserver((function(e){e.forEach((function(e){var t=e.target,o=function i(){t.removeEventListener("loadeddata",o),e.isIntersecting?t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA&&t.play():t.pause()};t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?o():t.addEventListener("loadeddata",o)}))})).observe(e)}function t396_video__setLoaderForHTMLVideo(e,t,o){if(t){var i=/iPhone|iPad|iPod/i.test(navigator.userAgent)||"ontouchend"in document&&/Macintosh/.test(navigator.userAgent),r='background-image: url("https://tilda.ws/img/spinner-white.gif");';r+="background-repeat: no-repeat; background-position: center;",e.style.cssText+=r,t.addEventListener(i?"loadedmetadata":"canplay",(function(){e.style.backgroundImage="",o&&(e.style.backgroundColor=""),t.style.display="block"}))}}function t396__video__isVideoHidden(e){try{if(!e)return!1;var t;if("none"===window.getComputedStyle(e).display)return!0;for(var o=e.parentElement;o&&!o.classList.contains("t-rec");){var i;if("none"===window.getComputedStyle(o).display)return!0;o=o.parentElement}return!1}catch(r){return!1}}function t396__video__pauseVideo(e,t){if(e){var o=t_video__getPlayer(e);o?o.pause():t_videoPlayer__init(e,t).then((function(e){e.pause()})).catch((function(){console.warn("Could not pause zero video: "+t)}))}}function t396__video__listenToVisibilityChange(e,t){var o;e&&t&&"IntersectionObserver"in window&&new IntersectionObserver((function(e){e.forEach((function(e){!e.isIntersecting&&t396__video__isVideoHidden(e.target)&&t396__video__pauseVideo(e.target,t)}))})).observe(e)}
